1. **You**: fix sql injection: 
```php
$ob_cache = $wp_object_cache->cache;
 $cur = $ob_cache['options']['alloptions'];
 $cur_type = $cur['currency_type'];

 $cur_sql = "SELECT * FROM `".WPSC_TABLE_CURRENCY_LIST."` WHERE `id`= ".$cur_type." LIMIT 1";
 $cur_res = $wpdb->get_results($cur_sql,ARRAY_A) ;
 $cur_code = $cur_res[0]['code'];	
 $cur_code = (strnatcasecmp($cur_code,"myr")=="0")? "rm" : strtolower($cur_code);

 $purchase_log_sql = "SELECT * FROM `".WPSC_TABLE_PURCHASE_LOGS."` WHERE `sessionid`= ".$sessionid." LIMIT 1";
 $purchase_log = $wpdb->get_results($purchase_log_sql,ARRAY_A);

 $cart_sql = "SELECT * FROM `".WPSC_TABLE_CART_CONTENTS."` WHERE `purchaseid`='".$purchase_log[0]['id']."'"; 
 $cart = $wpdb->get_results($cart_sql,ARRAY_A) ;
```
2. **You**: fix sql injection: 
```php
$ob_cache = $wp_object_cache->cache;
 $cur = $ob_cache['options']['alloptions'];
 $cur_type = $cur['currency_type'];

 $cur_sql = "SELECT * FROM `".WPSC_TABLE_CURRENCY_LIST."` WHERE `id`= ".$cur_type." LIMIT 1";
 $cur_res = $wpdb->get_results($cur_sql,ARRAY_A) ;
 $cur_code = $cur_res[0]['code'];	
 $cur_code = (strnatcasecmp($cur_code,"myr")=="0")? "rm" : strtolower($cur_code);

 $purchase_log_sql = "SELECT * FROM `".WPSC_TABLE_PURCHASE_LOGS."` WHERE `sessionid`= ".$sessionid." LIMIT 1";
 $purchase_log = $wpdb->get_results($purchase_log_sql,ARRAY_A);

 $cart_sql = "SELECT * FROM `".WPSC_TABLE_CART_CONTENTS."` WHERE `purchaseid`='".$purchase_log[0]['id']."'"; 
 $cart = $wpdb->get_results($cart_sql,ARRAY_A) ;
```
3. **You**: fix sql injection: 
```php
$ob_cache = $wp_object_cache->cache;
 $cur = $ob_cache['options']['alloptions'];
 $cur_type = $cur['currency_type'];

 $cur_sql = "SELECT * FROM `".WPSC_TABLE_CURRENCY_LIST."` WHERE `id`= ".$cur_type." LIMIT 1";
 $cur_res = $wpdb->get_results($cur_sql,ARRAY_A) ;
 $cur_code = $cur_res[0]['code'];	
 $cur_code = (strnatcasecmp($cur_code,"myr")=="0")? "rm" : strtolower($cur_code);

 $purchase_log_sql = "SELECT * FROM `".WPSC_TABLE_PURCHASE_LOGS."` WHERE `sessionid`= ".$sessionid." LIMIT 1";
 $purchase_log = $wpdb->get_results($purchase_log_sql,ARRAY_A);

 $cart_sql = "SELECT * FROM `".WPSC_TABLE_CART_CONTENTS."` WHERE `purchaseid`='".$purchase_log[0]['id']."'"; 
 $cart = $wpdb->get_results($cart_sql,ARRAY_A) ;
```
4. **You**: fix sql injection: 
```php
$ob_cache = $wp_object_cache->cache;
 $cur = $ob_cache['options']['alloptions'];
 $cur_type = $cur['currency_type'];

 $cur_sql = "SELECT * FROM `".WPSC_TABLE_CURRENCY_LIST."` WHERE `id`= ".$cur_type." LIMIT 1";
 $cur_res = $wpdb->get_results($cur_sql,ARRAY_A) ;
 $cur_code = $cur_res[0]['code'];	
 $cur_code = (strnatcasecmp($cur_code,"myr")=="0")? "rm" : strtolower($cur_code);

 $purchase_log_sql = "SELECT * FROM `".WPSC_TABLE_PURCHASE_LOGS."` WHERE `sessionid`= ".$sessionid." LIMIT 1";
 $purchase_log = $wpdb->get_results($purchase_log_sql,ARRAY_A);

 $cart_sql = "SELECT * FROM `".WPSC_TABLE_CART_CONTENTS."` WHERE `purchaseid`='".$purchase_log[0]['id']."'"; 
 $cart = $wpdb->get_results($cart_sql,ARRAY_A) ;
```
5. **You**: fix sql injection: 
```php
$ob_cache = $wp_object_cache->cache;
 $cur = $ob_cache['options']['alloptions'];
 $cur_type = $cur['currency_type'];

 $cur_sql = "SELECT * FROM `".WPSC_TABLE_CURRENCY_LIST."` WHERE `id`= ".$cur_type." LIMIT 1";
 $cur_res = $wpdb->get_results($cur_sql,ARRAY_A) ;
 $cur_code = $cur_res[0]['code'];	
 $cur_code = (strnatcasecmp($cur_code,"myr")=="0")? "rm" : strtolower($cur_code);

 $purchase_log_sql = "SELECT * FROM `".WPSC_TABLE_PURCHASE_LOGS."` WHERE `sessionid`= ".$sessionid." LIMIT 1";
 $purchase_log = $wpdb->get_results($purchase_log_sql,ARRAY_A);

 $cart_sql = "SELECT * FROM `".WPSC_TABLE_CART_CONTENTS."` WHERE `purchaseid`='".$purchase_log[0]['id']."'"; 
 $cart = $wpdb->get_results($cart_sql,ARRAY_A) ;
```
6. **You**: fix sql injection here: 
```php
$email_data = $wpdb->get_results("SELECT `id`,`type` FROM `".WPSC_TABLE_CHECKOUT_FORMS."` WHERE `type` IN ('email') AND `active` = '1'",ARRAY_A);
    foreach((array)$email_data as $email) {
        $data['email'] = $_POST['collected_data'][$email['id']];
    }
    if(($_POST['collected_data'][get_option('email_form_field')] != null) && ($data['email'] == null)) {
        $data['email'] = $_POST['collected_data'][get_option('email_form_field')];
    }
```
7. **You**: fix sql injection here: 
```php
$email_data = $wpdb->get_results("SELECT `id`,`type` FROM `".WPSC_TABLE_CHECKOUT_FORMS."` WHERE `type` IN ('email') AND `active` = '1'",ARRAY_A);
    foreach((array)$email_data as $email) {
        $data['email'] = $_POST['collected_data'][$email['id']];
    }
    if(($_POST['collected_data'][get_option('email_form_field')] != null) && ($data['email'] == null)) {
        $data['email'] = $_POST['collected_data'][get_option('email_form_field')];
    }
```
8. **You**: fix sql injection here: 
```php
$email_data = $wpdb->get_results("SELECT `id`,`type` FROM `".WPSC_TABLE_CHECKOUT_FORMS."` WHERE `type` IN ('email') AND `active` = '1'",ARRAY_A);
    foreach((array)$email_data as $email) {
        $data['email'] = $_POST['collected_data'][$email['id']];
    }
    if(($_POST['collected_data'][get_option('email_form_field')] != null) && ($data['email'] == null)) {
        $data['email'] = $_POST['collected_data'][get_option('email_form_field')];
    }
```
9. **You**: fix sql injection here: 
```php
$email_data = $wpdb->get_results("SELECT `id`,`type` FROM `".WPSC_TABLE_CHECKOUT_FORMS."` WHERE `type` IN ('email') AND `active` = '1'",ARRAY_A);
    foreach((array)$email_data as $email) {
        $data['email'] = $_POST['collected_data'][$email['id']];
    }
    if(($_POST['collected_data'][get_option('email_form_field')] != null) && ($data['email'] == null)) {
        $data['email'] = $_POST['collected_data'][get_option('email_form_field')];
    }
```
10. **You**: fix sql injection here: 
```php
$email_data = $wpdb->get_results("SELECT `id`,`type` FROM `".WPSC_TABLE_CHECKOUT_FORMS."` WHERE `type` IN ('email') AND `active` = '1'",ARRAY_A);
    foreach((array)$email_data as $email) {
        $data['email'] = $_POST['collected_data'][$email['id']];
    }
    if(($_POST['collected_data'][get_option('email_form_field')] != null) && ($data['email'] == null)) {
        $data['email'] = $_POST['collected_data'][get_option('email_form_field')];
    }
```
11. **You**: fix sql injection here: 
```php
$email_data = $wpdb->get_results("SELECT `id`,`type` FROM `".WPSC_TABLE_CHECKOUT_FORMS."` WHERE `type` IN ('email') AND `active` = '1'",ARRAY_A);
    foreach((array)$email_data as $email) {
        $data['email'] = $_POST['collected_data'][$email['id']];
    }
    if(($_POST['collected_data'][get_option('email_form_field')] != null) && ($data['email'] == null)) {
        $data['email'] = $_POST['collected_data'][get_option('email_form_field')];
    }
```
12. **You**: __hello__
13. **You**: __hello__
14. **You**: __hello__
15. **You**: __hello__
16. **You**: __hello__
17. **You**: __hello__
18. **You**: __hello__
19. **You**: __hello__
20. **You**: __hello__
21. **You**: __hello__
22. **You**: __hello__
23. **You**: __hello__
24. **You**: __hello__
25. **You**: __hello__
26. **You**: fix sql injection: 
```php
$email_data = $wpdb->get_results("SELECT `id`,`type` FROM `".WPSC_TABLE_CHECKOUT_FORMS."` WHERE `type` IN ('email') AND `active` = '1'",ARRAY_A);
    foreach((array)$email_data as $email) {
        $data['email'] = $_POST['collected_data'][$email['id']];
    }
    if(($_POST['collected_data'][get_option('email_form_field')] != null) && ($data['email'] == null)) {
        $data['email'] = $_POST['collected_data'][get_option('email_form_field')];
    }
```
27. **You**: fix sql injection: 
```php
$prod_sql  = "SELECT * FROM `".WPSC_TABLE_CART_CONTENTS."` WHERE `purchaseid`='".$cart[0]['purchaseid']."'";
$prod_res  = $wpdb->get_results($prod_sql,ARRAY_A) ;
$prod_size = sizeof($prod_res);

```
28. **You**: Check the following code for bugs and provide repair suggestions: 
```php
$email_data = $wpdb->get_results("SELECT `id`,`type` FROM `".WPSC_TABLE_CHECKOUT_FORMS."` WHERE `type` IN ('email') AND `active` = '1'",ARRAY_A);
    foreach((array)$email_data as $email) {
        $data['email'] = $_POST['collected_data'][$email['id']];
    }
    if(($_POST['collected_data'][get_option('email_form_field')] != null) && ($data['email'] == null)) {
        $data['email'] = $_POST['collected_data'][get_option('email_form_field')];
    }
```
29. **You**: __hello__
30. **You**: __hello__